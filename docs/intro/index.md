# Introduction

## Purpose of Container Format
「コンテナフォーマット」(IEC 63430)は、国際団体のIEC(International Electrotechnical Commission)で現在標準化が進められているデータの共通構造の規格です。  
センサデータのようなベンダごとに異なる構造を持つデータに対して、データレベルの標準インターフェイスとなります。  
異なる複数のベンダのセンサを組み合わせたサービスやフレキシブルな対応を低コストで実現するための基盤となり、  
また、既存の製品やサービスをコンテナフォーマット対応する事に複雑な仕様変更は不要です。

## Features
コンテナフォーマットの規格は以下の３つの特徴を有しています。

### ヘッダ情報の追加で製品やサービスのあらゆるデータをコンテナフォーマットに対応

コンテナは、ヘッダとペイロードの２つから成り立ちます。

- コンテナヘッダ
- ペイロード

![コンテナフォーマットのイメージ](container.drawio.png)

図1. コンテナフォーマットのイメージ

コンテナヘッダの各要素は仕様の中で定義され、要素の順序、長さなどが決定されています。

一方、ペイロードは要素やデータ構造を特定しません。
センサーの出力値やメモリセクタなどをそのまま格納できます。

コンテナを作ることは、`データに対して決められたヘッダをつけること` であり、
この特徴によって、コンテナフォーマット対応を容易にしています。

### 「スキーマ情報」を使ってデータから情報への変換手続きを共通化

スキーマ情報はコンテナのペイロード(=データ)から、情報を取り出すためのメタ情報である。

コンテナのペイロードは決まった構造を持たないので、
スキーマ情報によってペイロードから情報を取り出すためのデータ構造やメタデータをコンテナの外部で定義します。

![スキーマとペイロード](scheme.drawio.png)  
図2. スキーマ情報を利用して情報を取り出すイメージ

コンテナのペイロードに対して、スキーマ情報を利用して情報を取り出すことで、図のような情報を取り出す処理を共通化できます。

### リポジトリに蓄積されたスキーマ情報を参照することで情報への変換方法を共通化

スキーマリポジトリは、コンテナに対応するスキーマ情報を提供する機能を持ちます。

スキーマリポジトリがコンテナヘッダを元に対応するスキーマ情報を提供することで、
コンテナから情報を取り出して処理することができます。

![スキーマとスキーマリポジトリ](repository.drawio.png)

スキーマリポジトリからスキーマ情報を参照することで、
異なる複数のベンダのセンサであっても共通化された処理で利用できるようになるため、
複数ベンダのセンサやサービスを組み合わせて、フレキシブルにサービスを実現することができます。

## Before vs. After
コンテナフォーマットによって解決する課題の例をコンテナフォーマットの導入前後で示します。

### Before Standardization

標準フォーマットがない場合に発生する課題が解決できます。
様々なデバイスで発生するデータが標準化されていないため、ベンダーごとに異なるデータフォーマットを利用していため以下のような問題が発生する。   

- ベンダーの異なる多種のデバイスを組み合わせたサービスの実現が困難
- センサベンダごとにデータ構造が異なる/不明なため、センサベンダ提供のアプリケーションでしか処理できない。
- センサーの追加や変更に対し、アプリケーションの追加や変更が必要

 ![](before_standization.drawio.png)


### After Standardization

標準化されたコンテナフォーマットを利用することで、
示した課題を以下のように解決できます。

- ベンダーが異なる多種のデバイスを組み合わせたサービスを実現可能
- 共通処理を行うので共通のアプリケーションで、データを処理。
- センサーの追加や変更に対し、スキーマ情報の追加で、**フレキシブルな対応**を実現可能
 
 ![](after_standization.drawio.png)
